# ---
Brilliant work, Reza â€” now that your backend is seeded and stable, you're ready to shift gears and start building the **frontend experience**. Here's a clear next phase roadmap:

---

## ğŸ§­ Phase 2: Frontend Scenario Viewer

### âœ… Step 1: Create Scenario Page

In your Next.js app, scaffold:
```
/frontend/src/pages/scenario/[id].tsx
```

This page will:
- Fetch scenario data from the backend
- Display vitals, labs, imaging, and nurse report
- Prepare the UI for chat and order interactions

### ğŸ§ª Sample Fetch Logic
```tsx
import { useRouter } from 'next/router';
import { useEffect, useState } from 'react';
import axios from 'axios';

export default function ScenarioPage() {
  const { id } = useRouter().query;
  const [scenario, setScenario] = useState(null);

  useEffect(() => {
    if (id) {
      axios.get(`http://localhost:3000/scenarios/${id}`).then(res => {
        setScenario(res.data);
      });
    }
  }, [id]);

  if (!scenario) return <div>Loading...</div>;

  return (
    <div>
      <h1>{scenario.title}</h1>
      <p>{scenario.description}</p>
      <pre>{JSON.stringify(scenario.initialVitals, null, 2)}</pre>
      <p><strong>Nurse Report:</strong> {scenario.nurseReport}</p>
    </div>
  );
}
```

---

## ğŸ§± Step 2: Add Shared UI Components

Create reusable components:
- `VitalsPanel`
- `LabsPanel`
- `ChatPanel`
- `OrderPanel`
- `TimelinePanel`

Use Tailwind CSS or your preferred styling method.

---

## ğŸ” Step 3: Integrate Keycloak Authentication

- Protect scenario routes
- Pass JWT to backend for role-based access
- Store user info and roles in context

---

## ğŸ” Step 4: Connect Chat and Orders

- Add `chat` and `orders` modules to backend
- Create REST endpoints or WebSocket channels
- Use sharedTypes for `ChatMessage` and `Order`

---

## ğŸ“Š Step 5: Build Timeline and Logging

- Display actions chronologically
- Include vitals, orders, and chat events
- Prepare for assessment analytics later

---

Would you like me to help scaffold the frontend scenario page now, or start building the `chat` module in NestJS?
# ---
Awesome â€” letâ€™s build out the **frontend scenario viewer** step by step. This will be your first interactive page that connects to the backend and displays real scenario data.

---

## ğŸ§± Step 1: Create the Dynamic Scenario Page

Create this file:
```
/frontend/src/pages/scenario/[id].tsx
```

### ğŸ§ª Basic Page Setup
```tsx
import { useRouter } from 'next/router';
import { useEffect, useState } from 'react';
import axios from 'axios';
import { Scenario } from 'sharedTypes/dist/scenario'; // adjust path if needed

export default function ScenarioPage() {
  const { id } = useRouter().query;
  const [scenario, setScenario] = useState<Scenario | null>(null);

  useEffect(() => {
    if (id) {
      axios.get(`http://localhost:3000/scenarios/${id}`).then(res => {
        setScenario(res.data);
      });
    }
  }, [id]);

  if (!scenario) return <div className="p-4">Loading scenario...</div>;

  return (
    <div className="p-6 space-y-4">
      <h1 className="text-2xl font-bold">{scenario.title}</h1>
      <p className="text-gray-700">{scenario.description}</p>

      <section>
        <h2 className="text-xl font-semibold">Initial Vitals</h2>
        <ul className="list-disc pl-6">
          {Object.entries(scenario.initialVitals).map(([key, value]) => (
            <li key={key}>{key}: {value}</li>
          ))}
        </ul>
      </section>

      <section>
        <h2 className="text-xl font-semibold">Labs</h2>
        <ul className="list-disc pl-6">
          {scenario.labs.map((lab, i) => <li key={i}>{lab}</li>)}
        </ul>
      </section>

      <section>
        <h2 className="text-xl font-semibold">Imaging</h2>
        <ul className="list-disc pl-6">
          {scenario.imaging.map((img, i) => <li key={i}>{img}</li>)}
        </ul>
      </section>

      <section>
        <h2 className="text-xl font-semibold">Nurse Report</h2>
        <p className="italic">{scenario.nurseReport}</p>
      </section>
    </div>
  );
}
```

---

## ğŸ¨ Step 2: Add Tailwind CSS (if not already)

If you didnâ€™t enable Tailwind during setup:
```bash
npm install
npm install -D tailwindcss@latest postcss autoprefixer
```

### 3. **Manually create Tailwind config**
If `npx tailwindcss init -p` still fails, do this manually:

#### ğŸ”§ `tailwind.config.js`
```js
module.exports = {
  content: ["./src/**/*.{js,ts,jsx,tsx}"],
  theme: {
    extend: {},
  },
  plugins: [],
}
```

#### ğŸ”§ `postcss.config.js`
```js
module.exports = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
}
```

### 4. **Add Tailwind to your global CSS**
In `src/styles/globals.css` (or wherever your global styles live):
```css
@tailwind base;
@tailwind components;
@tailwind utilities;
```

---

## âœ… Final Check

Start your frontend:
```bash
npm run dev
```

Visit a page and inspect the HTML â€” Tailwind classes like `text-xl` or `p-4` should now apply styles.

---

If this still doesnâ€™t work, I can help you switch to a Vite-based setup or use a CDN-based Tailwind fallback. Want to test a basic Tailwind layout next to confirm itâ€™s working visually?

Update `tailwind.config.js`:
```js
content: ["./src/**/*.{js,ts,jsx,tsx}"]
```

Add to `globals.css`:
```css
@tailwind base;
@tailwind components;
@tailwind utilities;
```

---

## ğŸ” Step 3: Prepare for Keycloak Integration

Later, youâ€™ll:
- Protect this route
- Pass JWT to backend
- Show/hide UI based on role (e.g., student vs nurse)

---

## ğŸ§­ Next Steps

Now that the scenario viewer is working, you can:
1. Add `ChatPanel` and `OrderPanel` components
2. Scaffold the `chat` and `orders` modules in NestJS
3. Connect WebSocket or REST endpoints

Would you like to build the `ChatPanel` next or scaffold the backend `chat` module first?
# ---

now that Tailwind CSS is working, letâ€™s continue building out the **Scenario Viewer UI**. We'll start modularizing the interface into reusable components. Here's the plan:

## ğŸ§± Step 1: Create a `VitalsPanel` Component

This will display the initial vitals in a clean, styled layout.

### ğŸ”§ `frontend/src/components/VitalsPanel.tsx`
```tsx
import React from 'react';

interface VitalsPanelProps {
  vitals: Record<string, number>;
}

export const VitalsPanel: React.FC<VitalsPanelProps> = ({ vitals }) => {
  return (
    <div className="bg-white shadow rounded p-4">
      <h2 className="text-lg font-semibold mb-2">Initial Vitals</h2>
      <div className="grid grid-cols-2 gap-2">
        {Object.entries(vitals).map(([key, value]) => (
          <div key={key} className="flex justify-between border-b py-1">
            <span className="text-gray-600">{key}</span>
            <span className="font-medium">{value}</span>
          </div>
        ))}
      </div>
    </div>
  );
};
```

---

## ğŸ§ª Step 2: Use It in `[id].tsx`

Update your scenario page to import and use the panel:

```tsx
import { VitalsPanel } from '@/components/VitalsPanel';

// Inside your component render:
<VitalsPanel vitals={scenario.initialVitals} />
```

letâ€™s move on and build the **LabsPanel** component to display lab results in a clean, readable format.

## ğŸ§ª Step 2: Create `LabsPanel` Component

### ğŸ”§ `frontend/src/components/LabsPanel.tsx`
```tsx
import React from 'react';

interface LabsPanelProps {
  labs: string[];
}

export const LabsPanel: React.FC<LabsPanelProps> = ({ labs }) => {
  if (!labs || labs.length === 0) return null;

  return (
    <div className="bg-white shadow rounded p-4">
      <h2 className="text-lg font-semibold mb-2">Lab Results</h2>
      <ul className="list-disc pl-5 space-y-1">
        {labs.map((lab, index) => (
          <li key={index} className="text-gray-700">{lab}</li>
        ))}
      </ul>
    </div>
  );
};
```

---

## ğŸ§© Step 3: Use It in `[id].tsx`

Import and render it below the vitals panel:

```tsx
import { LabsPanel } from '@/components/LabsPanel';

<LabsPanel labs={scenario.labs} />
```

letâ€™s build the **ImagingPanel** next to complete the core scenario data display.

## ğŸ–¼ Step 3: Create `ImagingPanel` Component

### ğŸ”§ `frontend/src/components/ImagingPanel.tsx`
```tsx
import React from 'react';

interface ImagingPanelProps {
  imaging: string[];
}

export const ImagingPanel: React.FC<ImagingPanelProps> = ({ imaging }) => {
  if (!imaging || imaging.length === 0) return null;

  return (
    <div className="bg-white shadow rounded p-4">
      <h2 className="text-lg font-semibold mb-2">Imaging</h2>
      <ul className="list-disc pl-5 space-y-1">
        {imaging.map((img, index) => (
          <li key={index} className="text-gray-700">{img}</li>
        ))}
      </ul>
    </div>
  );
};
```

---

## ğŸ§© Step 4: Use It in `[id].tsx`

Import and render it below the labs panel:

```tsx
import { ImagingPanel } from '@/components/ImagingPanel';

<ImagingPanel imaging={scenario.imaging} />
```
# ---
Perfect â€” letâ€™s build the **ChatPanel** component and prepare the backend for chat integration. This will allow users to interact with the simulated patient or nurse via text.

---

## ğŸ’¬ Step 1: Create `ChatPanel` Component

### ğŸ”§ `frontend/src/components/ChatPanel.tsx`
```tsx
import React, { useState } from 'react';

interface ChatMessage {
  sender: 'user' | 'system';
  text: string;
  timestamp: string;
}

interface ChatPanelProps {
  scenarioId: string;
}

export const ChatPanel: React.FC<ChatPanelProps> = ({ scenarioId }) => {
  const [messages, setMessages] = useState<ChatMessage[]>([]);
  const [input, setInput] = useState('');

  const sendMessage = async () => {
    if (!input.trim()) return;

    const userMessage: ChatMessage = {
      sender: 'user',
      text: input,
      timestamp: new Date().toISOString(),
    };

    setMessages([...messages, userMessage]);
    setInput('');

    // Send to backend
    const res = await fetch(`http://localhost:3000/chat/${scenarioId}`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ message: input }),
    });

    const data = await res.json();
    const systemMessage: ChatMessage = {
      sender: 'system',
      text: data.reply,
      timestamp: new Date().toISOString(),
    };

    setMessages(prev => [...prev, systemMessage]);
  };

  return (
    <div className="bg-white shadow rounded p-4 space-y-4">
      <h2 className="text-lg font-semibold">Chat</h2>
      <div className="h-64 overflow-y-auto border rounded p-2 space-y-2">
        {messages.map((msg, i) => (
          <div key={i} className={`p-2 rounded ${msg.sender === 'user' ? 'bg-blue-100 text-right' : 'bg-gray-100 text-left'}`}>
            <p>{msg.text}</p>
          </div>
        ))}
      </div>
      <div className="flex gap-2">
        <input
          className="flex-1 border rounded px-2 py-1"
          value={input}
          onChange={e => setInput(e.target.value)}
          placeholder="Type your message..."
        />
        <button className="bg-blue-500 text-white px-4 py-1 rounded" onClick={sendMessage}>
          Send
        </button>
      </div>
    </div>
  );
};
```

---

## ğŸ§© Step 2: Use It in `[id].tsx`

```tsx
import { ChatPanel } from '@/components/ChatPanel';

<ChatPanel scenarioId={scenario.id} />
```

---

## ğŸ›  Step 3: Scaffold Backend `chat` Module

In NestJS:
```bash
nest generate module chat
nest generate controller chat
nest generate service chat
```

### ğŸ”§ `chat.controller.ts`
```ts
@Post(':scenarioId')
async sendMessage(
  @Param('scenarioId') scenarioId: string,
  @Body('message') message: string
) {
  const reply = await this.chatService.generateReply(scenarioId, message);
  return { reply };
}
```

### ğŸ”§ `chat.service.ts`
```ts
@Injectable()
export class ChatService {
  async generateReply(scenarioId: string, message: string): Promise<string> {
    // Placeholder logic â€” later integrate LLM or scenario branching
    return `Echo: ${message}`;
  }
}
```

---

Let me know if you want to wire this up to your scenario branching logic or integrate Ollama for LLM-based replies next.
# ---
# ---
# ---
# ---
# ---
# ---
# ---
# ---
# ---
# ---
# ---
# ---
# ---
# ---
# ---
